<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>Phylogenetics: Distances Lab</title>
    <link href="../lab2-PaupMesquiteNEXUS/EEB349.css" rel="stylesheet" type="text/css">
</head>

<body>
    <table width="972" height="160" border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td height="49" colspan="2" valign="top">
                <p>
                    <span class="pagetitle">BIOL 848: Phylogenetic Methods</span><span class="pagetitle"></span>
                </p>
            </td>
        </tr>
        <tr>
        </tr>
    </table>
    <p>
        This lab was written by Paul O. Lewis and being used in BIOL 848 (with slight modifications) by Mark Holder with Paul's permission.
    </p>
    <tr>
        <td>
            The goal of this lab exercise is to show you how to conduct distance-based analyses in PAUP* and FastME.
        </td>
    </tr>


</html>
<!--




<a name="Using_SplitsTree"></a><h3> Using SplitsTree </h3>
<p>We will now abandon PAUP* and explore a program called SplitsTree for a moment. SplitsTree has been around for several years, but the version we are using (SplitsTree 4) is still in the beta test stage, so just be aware that you will notice a few glitches. If you need to use SplitsTree for a paper, and version 4 does not do the job for you, you can still download older versions (e.g. 3.2) that are much more stable at the SplitsTree home page.
</p><p>SplitsTree is the primary program used to perform split decomposition, which I discussed in this lecture. If there is no shortcut for SplitsTree on your desktop, you can make one by going to Start &gt; My Computer &gt; C: drive &gt; Program Files &gt; SplitsTree and dragging (with the right mouse button) the program icon to your desktop. When you release the right mouse button, "Create shortcut here" should be one of the options presented to you.
</p><p>Start SplitsTree by double-clicking its icon. After it loads, use File &gt; Open... to navigate to the Examples folder and open <tt>bees.nex</tt>. If you are having trouble finding this file, use the Look In list box in the File Open dialog to go all the way up to My Computer, then come down through Local Disk (C:), then Program Files, then SplitsTree, and finally look in the Examples subdirectory. Note the webbiness, which indicates that some characters prefer one tree, and other characters prefer a different tree.
</p><p>In some cases, changing the model can help make the distances more additive, and SplitsTree can be used to visually explore the effects of applying different models. Try changing to the LogDet model by choosing Distances &gt; Logdet from the main menu. Press the "Apply" button when it appears, then take a look at the tree again.
</p>
<ul><li> <i>Did correcting the Hamming distances (raw dissimilarity) using the Logdet model help to make the distances more additive?</i>
</li></ul>
<div class="thumb tright"><div style="width:182px;"><a href="/eebedia/index.php/Image:New_Zealand_map.PNG" class="internal" title="Map of NZ showing major cities. Click to enlarge"><img src="/eebedia/images/thumb/1/1a/New_Zealand_map.PNG/180px-New_Zealand_map.PNG" alt="Map of NZ showing major cities. Click to enlarge" width="180" height="329" longdesc="/eebedia/index.php/Image:New_Zealand_map.PNG" /></a>  <div class="thumbcaption"><div class="magnify" style="float:right"><a href="/eebedia/index.php/Image:New_Zealand_map.PNG" class="internal" title="Enlarge"><img src="/eebedia/skins/common/images/magnify-clip.png" width="15" height="11" alt="Enlarge" /></a></div>Map of NZ showing major cities. Click to enlarge</div></div></div>Most phylogeny programs will not make it clear when a tree is not the best way to represent the data. SplitsTree excels at this. Open the example file <tt>colors.nex</tt>. The distance matrix provided in this case comprises pairwise distances between different colors, which you would not expect to be expecially treelike. The example file <tt>south.nex</tt> contains the pairwise distances between cities on the south island of New Zealand (plus Wellington, which is the southernmost city on the north island). A quick look at the map of New Zealand on the right will convince you that the "tree" shown by SplitsTree is actually a fairly good map of the south island of New Zealand!
<p>SplitsTree makes use of the NEXUS format, so you can create a distance matrix in PAUP* and then read it in to SplitsTree. SplitsTree uses several types of blocks that PAUP* does not recognize, however, including <tt>Splits</tt>, <tt>st_graph</tt> and <tt>st_assumptions</tt>. Some of these blocks are added to your data file when you execute it, which is why when you try to close a window SplitsTree asks you whether you want to save the modified data file.
</p><p>Click on the "Data" tab, then expand Taxa and Splits. The Splits section is where you will find the weights for each split shown in the tree, in case you want to report these in a publication. Previous versions of SplitsTree would show these weights on the tree itself if you asked, but thus far I have been unsuccessful at getting the Java version to do this. The Java version does do a nice job of saving the tree in various graphics file formats, including jpg, eps, svg, gif or png. Use the File &gt; Export Image... menu command to create a file of one of these types.
</p>
<a name="Checking_your_hand-calculated_split_decomposition"></a><h3> Checking your hand-calculated split decomposition </h3>
<p>The first step to checking the hand-calculated splitstree you did for homework #3 is to create a NEXUS file containing a distances block. This file can be read into the program SplitsTree and the split decomposition calculated for comparison. Below is what a NEXUS file containing a distances block looks like. (The taxa block is also required by the SplitsTree program.) <b>Be sure to replace the distances in this file with the JC distances you calculated by hand!</b> The diagonal elements should be left as 0.0, however.
</p>
<pre>#nexus

begin taxa;
  dimensions ntax=4;
  taxlabels taxon1 taxon2 taxon3 taxon4;
end;

begin distances;
  dimensions ntax=4;
  format diagonal labels triangle=lower;
  matrix
    taxon1 0.0
    taxon2 0.12 0.0
    taxon3 0.13 0.23 0.0
    taxon4 0.14 0.24 0.34 0.0
 &nbsp;;
end;
</pre>
<p>After replacing the pairwise distances with the JC distances you calculated for homework #3, save the file as homework3.nex and open it in SplitsTree. You will see what looks like a splitstree appear after the homework3.nex file is executed, but this is actually a NeighborNet tree rather than a split decomposition tree. In this simple case, they are identical, but you should choose Networks &gt; SplitDecomposition to switch to the split decomposition tree (if only so that you will know how to do this in the future). Hit Apply when the dialog box appears, and then you can close the Networks dialog box.
</p><p>Now you should enlarge the central box in your tree (more appropriately called a network in SplitsTree) by clicking repeatedly on the + magnifying glass button at the top of the window (or, alternatively, choosing View &gt; Zoom In repeatedly from the main menu). Once the box occupies a substantial proportion of the screen, center in in the window and choose View &gt; Nodes and Edges... from the main menu. Once the Nodes and Edges... dialog box appears, click on the Edges tab and make sure that the Weights checkbox is checked. Now close the Nodes and Edges... checkbox, and view the tree again. Try clicking on one side of the box to see which numerical value goes with that split. You should find that the values are the same as those you computed for homework #3.
</p>

-->